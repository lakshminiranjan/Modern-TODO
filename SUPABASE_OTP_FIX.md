# Supabase OTP Fix Guide

This guide will help you fix the issue with missing OTP codes in password reset emails.

## Problem

The password reset emails are being sent, but the OTP code is missing in the email content.

## Solution

The issue is with the template variable format in the Supabase email template. We need to update the template to use the correct variable format.

### 1. Update Email Template in Supabase Dashboard

1. Log in to your Supabase Dashboard
2. Navigate to **Authentication** > **Email Templates**
3. Click on the **Reset Password** template
4. Replace the HTML content with the template from `fixed-reset-password-template.html`
5. Make sure the template includes `{{ .Token }}` (not `{{ .Data.otp }}` or `{{ .OTP }}`)
6. Save the changes

### 2. Configure Authentication Settings

1. In the Supabase Dashboard, go to **Authentication** > **Providers**
2. Under **Email**, make sure:
   - **Confirm email** is set to **No**
   - **Enable Email Confirmations** is disabled
   - **Password Reset Link Lifespan** is set to **0** seconds

### 3. Test the Password Reset Flow

1. Try the password reset flow again
2. Check the email received - it should now contain the OTP code

## Important Notes

- The variable format `{{ .Token }}` is the correct format for Supabase OTP codes
- The OTP code is generated by Supabase, not by your application
- The email template must be properly formatted HTML
- Make sure your Supabase project has a working email provider configured

## Troubleshooting

If you're still having issues:

1. Check the browser console for any errors
2. Verify that the email template is saved correctly in the Supabase Dashboard
3. Make sure the email provider is properly configured
4. Try clearing your browser cache and trying again
5. Check the Supabase logs for any errors

## Additional Resources

- [Supabase Auth Documentation](https://supabase.com/docs/guides/auth)
- [Supabase Email Templates](https://supabase.com/docs/guides/auth/auth-email-templates)